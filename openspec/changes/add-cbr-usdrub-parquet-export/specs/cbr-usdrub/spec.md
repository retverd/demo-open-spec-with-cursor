## ADDED Requirements

### Requirement: Получение курса USD/RUB от ЦБ РФ за последние 7 дней

Система MUST получать официальный курс USD/RUB от ЦБ РФ за диапазон дат \([today-6; today]\), где `today` — текущая локальная календарная дата запуска.

#### Scenario: Успешное получение данных за весь диапазон

- **WHEN** система запрашивает данные у ЦБ РФ за диапазон \([today-6; today]\)
- **THEN** система ДОЛЖНА получить набор значений курса в указанном диапазоне
- **AND THEN** набор ДОЛЖЕН содержать значения за все даты в диапазоне, которые возвращает источник

#### Scenario: За текущий день нет опубликованного значения

- **WHEN** система запрашивает данные у ЦБ РФ за диапазон \([today-6; today]\)
- **AND WHEN** источник не возвращает значение за `today`
- **THEN** система ДОЛЖНА считать результат частично успешным
- **AND THEN** система ДОЛЖНА продолжить обработку и сохранить все доступные значения в диапазоне

#### Scenario: Ошибка получения данных (сетевой сбой/ошибка источника)

- **WHEN** система запрашивает данные у ЦБ РФ за диапазон \([today-6; today]\)
- **AND WHEN** запрос к источнику завершается ошибкой
- **THEN** система ДОЛЖНА завершиться с ошибкой
- **AND THEN** система НЕ ДОЛЖНА записывать новый выходной Parquet-файл

### Requirement: Сохранение истории курса в Parquet в локальную папку

Система MUST сохранять полученную историю курса USD/RUB в **Parquet** файл в локальную папку.

#### Scenario: Папка назначения отсутствует

- **WHEN** система сохраняет Parquet-файл в локальную папку
- **AND WHEN** папка назначения отсутствует
- **THEN** система ДОЛЖНА создать папку назначения
- **AND THEN** система ДОЛЖНА сохранить Parquet-файл

#### Scenario: Имя выходного файла детерминировано и привязано к конечной дате

- **WHEN** система сохраняет результат за диапазон \([today-6; today]\)
- **THEN** имя выходного файла ДОЛЖНО быть `cbr_usdrub_YYYY-MM-DD.parquet`
- **AND THEN** `YYYY-MM-DD` ДОЛЖНО соответствовать значению `today`

#### Scenario: Минимальная схема данных в Parquet

- **WHEN** система сохраняет историю курса в Parquet
- **THEN** Parquet ДОЛЖЕН содержать минимум следующие поля: `date`, `pair`, `rate`, `source`, `retrieved_at`
- **AND THEN** `pair` ДОЛЖНО быть равно `USD/RUB`
- **AND THEN** `source` ДОЛЖНО быть равно `CBR`
